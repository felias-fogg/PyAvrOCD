<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Connecting to the target - PyAvrOCD</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Connecting to the target";
        var mkdocs_page_input_path = "connect-to-target.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> PyAvrOCD
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Installation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../install-link/">PyAvrOCD</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../debugging-software/">Debugging software</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Usage</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../configuration/">Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../board-preparation/">Preparing the target</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Connecting to the target</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#connecting-to-a-debugwire-target">Connecting to a debugWIRE target</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#spi-programming-header">SPI programming header</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#connecting-to-targets-with-an-spi-programming-header">Connecting to targets with an SPI programming header</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#connecting-to-targets-without-an-spi-programming-header">Connecting to targets without an SPI programming header</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#connecting-to-a-jtag-target">Connecting to a JTAG target</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#connecting-to-targets-with-a-jtag-header">Connecting to targets with a JTAG header</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#connecting-to-targets-without-a-jtag-header">Connecting to targets without a JTAG header</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#connecting-to-updi-and-pdi">Connecting to UPDI and PDI</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../command-line-options/">Invoking the server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../debugging/">Debugging on the target</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../monitor-commands/">Monitor commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../restore-original-state/">Restoring the target</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Supported devices</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../supported-mcus/">MCUs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../supported-boards/">Boards</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../supported-debuggers/">Hardware debuggers</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Caveats</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../disclaimer/">Disclaimer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../debugwire-risks/">debugWIRE</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../flash-wear/">Flash wear</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../limitations/">Limitations</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../license-link/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../release-notes/">Release notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../contributing/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../credits-link/">Credits</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../code_of_conduct-link/">Code of conduct</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">PyAvrOCD</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Usage</li>
      <li class="breadcrumb-item active">Connecting to the target</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/felias-fogg/PyAvrOCD/edit/master/docs/connect-to-target.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="connecting-the-hardware-debugger-to-a-target">Connecting the hardware debugger to a target</h1>
<p>The hardware debuggers have different connectors. The Microchip debuggers Snap and PICkit4 have an eight-pin SIL connector, where a triangle marks pin 1. This connector is not compatible with any AVR debug connector.</p>
<p>If you want to connect to your target board with a standard SPI or JTAG cable, you can buy an adapter board for AVR connectors from Microchip, as shown in the following picture.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/SNAP-adapter.JPG" width="70%">
</p>

<p>Atmel-ICE, Power Debugger, and JTAGICE3 all feature a keyed 10-pin, 50-mil JTAG header. For these debuggers, adapters are either already included or must be purchased separately. For AVR targets, one should, of course, use the header marked <code>AVR</code>.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/Atmel-adapter.JPG" width="70%">
</p>
<p>The <a href="https://github.com/felias-fogg/dw-link">dw-link</a> debugger uses the header on the Arduino Uno. The most convenient way is to prepare an ISP cable with a broken-out RESET and VCC cable as shown in the the following picture.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/dw-link-spi.jpeg" width="70%">
</p>

<p>If a dw-link shield is used, one can use the standard 6-pin SPI header.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/dw-link.jpeg" width="70%">
</p>

<p>Finally, all EDBG debuggers are easy to use. Since they are embedded debuggers, the connection to the target is already on the board.</p>
<p>Depending on which debugging interface the target has, the target board may provide a standard debugging header for this interface. I very much prefer to work with target boards that have the appropriate debugging headers on board. Otherwise, you may easily confuse a connection, and then nothing works.</p>
<p>If you do not have the standard headers on board or you are using a breadboard, then you have to connect each line using a jumper cable or the Atmel squid cable, as shown in the following picture.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/pickit4-connect.png" width="70%">
</p>

<p>In this case, it is essential to consult the user guide of the programmer and the <a href="https://pinouts.de">pinout of the MCU</a> in the datasheet or the documentation of the respective core to make the correct connections.</p>
<h2 id="connecting-to-a-debugwire-target">Connecting to a debugWIRE target</h2>
<p>In principle, only two wires are necessary to connect your hardware debugger to a target chip or board: the debugWIRE line, which is the target chip's RESET line, and GND. Since the debugger also needs to know which voltage the target board uses, the Vcc line is also necessary. Note that none of the commercial debuggers source the target. They only have voltage-sensing lines to drive the level-shifting hardware.</p>
<p>Since one also wants to change into and out of debugWIRE mode, change fuses, or upload firmware, it is necessary to connect all 6 SPI programming lines to the target: VTG, GND, RESET, MOSI, MISO, and SCK. For this reason, using all SPI programming lines makes a lot of sense. Moreover, most of the time, an SPI connector is already on the target board.</p>
<h3 id="spi-programming-header">SPI programming header</h3>
<p>There are two types of SPI programming connectors. The more recent type has six pins, and the older type has 10 pins, as shown in the following diagram (based on a diagram from <a href="https://commons.wikimedia.org/wiki/File:Isp_headers.svg">Wikipedia</a>, which provides a top view of the headers on a PCB.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/Isp_headers.svg.png" width="40%">
</p>

<p>Note the notches on the left side of the headers. Since almost all SPI programming plugs are keyed, you can only plug them in in the correct orientation. However, the headers sometimes do not have notches. In this case, pin 1 is usually marked in some way, either with a dot, a star, or with the number 1. Similarly, plugs also come unkeyed. In this case, again, pin 1 is marked in some way.</p>
<h3 id="connecting-to-targets-with-an-spi-programming-header">Connecting to targets with an SPI programming header</h3>
<p>If the target board has an SPI programming header, it is easy to connect to it. Simply use the SPI programming cable and plug it into the target board's header. Be aware of the correct orientation when the header is not keyed! For all the Arduino boards, pin 1 is always oriented towards the USB connector. However, if you plug it in the wrong way, nothing will be destroyed.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/atmel-ice-connect.png" width="70%">
</p>

<h3 id="connecting-to-targets-without-an-spi-programming-header">Connecting to targets without an SPI programming header</h3>
<p>If the target does not feature an SPI programming header, you need to connect 6 cables. If you are working with a breadboard, you may consider buying an <a href="https://www.adafruit.com/product/1465">SPI header breadboard adapter</a>. Otherwise, you need to connect each pin individually. <strong>Atmel-ICE</strong>, <strong>Power Debugge</strong>r, and <strong>JTAGICE3</strong> have a so-called 10-pin mini-squid cable. The pin mapping for those debuggers is as follows.</p>
<table>
<thead>
<tr>
<th>Atmel Debugger</th>
<th>Mini-squid pin</th>
<th>Target pin</th>
<th>SPI pin</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pin 1 (TCK)</td>
<td>1</td>
<td>SCK</td>
<td>3</td>
</tr>
<tr>
<td>Pin 2 (GND)</td>
<td>2</td>
<td>GND</td>
<td>6</td>
</tr>
<tr>
<td>Pin 3 (TDO)</td>
<td>3</td>
<td>MISO</td>
<td>1</td>
</tr>
<tr>
<td>Pin 4 (VTG)</td>
<td>4</td>
<td>VTG</td>
<td>2</td>
</tr>
<tr>
<td>Pin 5 (TMS)</td>
<td>5</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Pin 6 (nSRST)</td>
<td>6</td>
<td>RESET (debugWIRE)</td>
<td>5</td>
</tr>
<tr>
<td>Pin  (N.C.)</td>
<td>7&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Pin 8 (nTRST)</td>
<td>8</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Pin 9 (TDI)</td>
<td>9</td>
<td>MOSI</td>
<td>4</td>
</tr>
<tr>
<td>Pin 10 (GND)</td>
<td>0</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>For <strong>PICkit4</strong> and <strong>SNAP</strong>, such a table looks as follows, with pin 1 marked by a triangle.</p>
<table>
<thead>
<tr>
<th>MBLAP Debugger</th>
<th>Pin #</th>
<th>Target pin</th>
<th>SPI pin</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pin 1 (TVPP)</td>
<td>1</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Pin 2 (TVDD)</td>
<td>2</td>
<td>VTG</td>
<td>2</td>
</tr>
<tr>
<td>Pin 3 (GND)</td>
<td>3</td>
<td>GND</td>
<td>6</td>
</tr>
<tr>
<td>Pin 4 (PGD)</td>
<td>4</td>
<td>MISO</td>
<td>1</td>
</tr>
<tr>
<td>Pin 5 (PGC)</td>
<td>5</td>
<td>SCK</td>
<td>3</td>
</tr>
<tr>
<td>Pin 6 (TAUX)</td>
<td>6</td>
<td>RESET (debugWIRE)</td>
<td>5</td>
</tr>
<tr>
<td>Pin 7 (TTDI)</td>
<td>7</td>
<td>MOSI</td>
<td>4</td>
</tr>
<tr>
<td>Pin 8 (TTMS)</td>
<td>8</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>When you want to connect a <strong>dw-link</strong> debugger without a dw-link probe shield to a target, you can use jumper cables using the following pin mapping.</p>
<table>
<thead>
<tr>
<th>dw-link Arduino Uno pins</th>
<th>Target pin</th>
<th>SPI pin</th>
</tr>
</thead>
<tbody>
<tr>
<td>D8</td>
<td>RESET (debugWIRE)</td>
<td>5</td>
</tr>
<tr>
<td>D11</td>
<td>MOSI</td>
<td>4</td>
</tr>
<tr>
<td>D12</td>
<td>MISO</td>
<td>1</td>
</tr>
<tr>
<td>D13</td>
<td>SCK</td>
<td>3</td>
</tr>
<tr>
<td>5V (if powered by debugger)</td>
<td>Vcc</td>
<td>2</td>
</tr>
<tr>
<td>GND</td>
<td>GND</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>With a dw-link probe shield, it is best to construct or buy a cable with a 6-pin SPI programming plug on one end and single Dupont pins on the other.</p>
<h2 id="connecting-to-a-jtag-target">Connecting to a JTAG target</h2>
<p>Note that in order to use the JTAG connection, you might first need to enable the JTAG pins by programming the JTAGEN fuse via SPI programming. On chips fresh from the factory, this fuse is programmed. On Arduino boards, JTAGEN is disabled.</p>
<p>For AVR MCUs, there is a standard pinout as follows.</p>
<p align="center"> <img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/jtag-header-MC.png" width="25%"">
</p>

<p>Sometimes, pin 8 is connected to nTREST, which we do not need, though. The crucial pins are TCK (JTAG clock), TDO and TDI (data lines), and TMS (control line). In addition, we have nSRST, the reset line, and VTref and GND.</p>
<h3 id="connecting-to-targets-with-a-jtag-header">Connecting to targets with a JTAG header</h3>
<p>Again, if there is a JTAG header on the board, connecting the board is a breeze. Simply use the right cable.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/Atmel-ICE+MCUdude.jpeg" width="80%">
</p>
<h3 id="connecting-to-targets-without-a-jtag-header">Connecting to targets without a JTAG header</h3>
<p>When debugging a program running on an Arduino Mega or Leonardo, you could use an <a href="https://github.com/felias-fogg/PyAvrOCD/tree/main/pcbs/arduino-jtag/">adapter</a> that plugs into the header, as shown in the following picture.</p>
<p align="center">
  <img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/Mega-Adapter.png" width="70%">
</p>

<p>Otherwise, you must connect the wires individually, referring to the Arduino Mega's pinout and the header on the debugger. Here is an example for connecting PICkit4 (or Snap) to an Arduino Mega 2560.</p>
<p align="center">
<img src="https://raw.githubusercontent.com/felias-fogg/PyAvrOCD/refs/heads/main/docs/pics/pickit4+mega.jpeg" width="70%">
</p>

<p>The pin mapping for the PICkit4 looks as follows, where I have added the Arduino pins in the last column.</p>
<table>
<thead>
<tr>
<th>MBLAP Debugger</th>
<th>Pin #</th>
<th>Target pin</th>
<th>JTAG pin</th>
<th>Mega pin</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pin 1 (TVPP)</td>
<td>1</td>
<td>NC&nbsp;</td>
<td>&nbsp;</td>
<td></td>
</tr>
<tr>
<td>Pin 2 (TVDD)</td>
<td>2</td>
<td>VTG</td>
<td>4</td>
<td>5V</td>
</tr>
<tr>
<td>Pin 3 (GND)</td>
<td>3</td>
<td>GND</td>
<td>2, 10</td>
<td>GND</td>
</tr>
<tr>
<td>Pin 4 (PGD)</td>
<td>4</td>
<td>TDO</td>
<td>3</td>
<td>A6</td>
</tr>
<tr>
<td>Pin 5 (PGC)</td>
<td>5</td>
<td>TSCK</td>
<td>1</td>
<td>A4</td>
</tr>
<tr>
<td>Pin 6 (TAUX)</td>
<td>6</td>
<td>RESET</td>
<td>6</td>
<td>RESET</td>
</tr>
<tr>
<td>Pin 7 (TTDI)</td>
<td>7</td>
<td>TDI</td>
<td>9</td>
<td>A7</td>
</tr>
<tr>
<td>Pin 8 (TTMS)</td>
<td>8</td>
<td>TMS&nbsp;</td>
<td>5&nbsp;</td>
<td>A5</td>
</tr>
</tbody>
</table>
<p>For the Atmel debuggers, the setup appears as follows, where the JTAG pin corresponds to the mini-squid numbering. I have additionally added the corresponding Mega pin.</p>
<table>
<thead>
<tr>
<th>Atmel Debugger</th>
<th>Mini-squid pin = JTAG pin</th>
<th>Target pin</th>
<th>Mega pin</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pin 1 (TCK)</td>
<td>1</td>
<td>TCK</td>
<td>A4</td>
</tr>
<tr>
<td>Pin 2 (GND)</td>
<td>2</td>
<td>GND</td>
<td>GND</td>
</tr>
<tr>
<td>Pin 3 (TDO)</td>
<td>3</td>
<td>TDO</td>
<td>A6</td>
</tr>
<tr>
<td>Pin 4 (VTG)</td>
<td>4</td>
<td>VTG</td>
<td>5V</td>
</tr>
<tr>
<td>Pin 5 (TMS)</td>
<td>5</td>
<td>TMS&nbsp;</td>
<td>A5</td>
</tr>
<tr>
<td>Pin 6 (nSRST)</td>
<td>6</td>
<td>RESET</td>
<td>RESET</td>
</tr>
<tr>
<td>Pin  7 (N.C.)</td>
<td>7&nbsp;</td>
<td>NC&nbsp;</td>
<td></td>
</tr>
<tr>
<td>Pin 8 (nTRST)</td>
<td>8</td>
<td>NC&nbsp;</td>
<td></td>
</tr>
<tr>
<td>Pin 9 (TDI)</td>
<td>9</td>
<td>TDI</td>
<td>A7</td>
</tr>
<tr>
<td>Pin 10 (GND)</td>
<td>0</td>
<td>GND&nbsp;</td>
<td>GND</td>
</tr>
</tbody>
</table>
<h2 id="connecting-to-updi-and-pdi">Connecting to UPDI and PDI</h2>
<p>Will be treated later when implemented.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../board-preparation/" class="btn btn-neutral float-left" title="Preparing the target"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../command-line-options/" class="btn btn-neutral float-right" title="Invoking the server">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/felias-fogg/PyAvrOCD" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../board-preparation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../command-line-options/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
